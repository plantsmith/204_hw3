---
title: "Distributional Consequences of the Clean Energy Transition"
author: "Natalie Smith"
format: 
  html:
    code-fold: true
    toc: true
    number-sections: true
    embed-resources: true
theme: Litera
editor: visual
execute:
  echo: true
  message: false
  warning: false
---

Use the following set of facts:

-   We are concerned about the environmental inequities that may arise between DAC and non DAC communities in California due to mining of lithium needed to produce batteries in electric vehicles (EVs). We therefore will model the California EV market with two consumer groups: DAC and non-DAC.

-   Initially, there is no intervention in the EV market.

-   The current EV price (without any intervention) is \$50,000 per vehicle.

-   The marginal cost of producing an EV is linear and has a price-intercept of 0. For the purposes of this exercise, you can assume that California is self-contained in supply and demand (you don’t need to worry about global EV or mining markets). This is of course unrealistic, but note there have been large efforts by the Biden Administration to create a domestic battery supply chain, making the tradeoffs analyzed here highly policy relevant.

```{r}
library(tidyverse)
```

## 1.

The data set HW3 data.csv provides price (in \$) and quantity (in number of EVs) estimates of demand per year for both DAC and non-DAC groups. Run linear regressions (with an intercept) to estimate the demand curves for DAC and non-DAC consumers. What are 2-3 reasons you can think that may explain the differences in demand you estimate?

```{r}
# Load the data
data <- read.csv("HW3_data.csv") %>% 
  janitor::clean_names()
```

```{r}
# Run linear regressions (with an intercept) to estimate the demand curves for DAC and non-DAC consumers
dac <- lm(price_dollars ~ q_dac, data = data)
non_dac <- lm(price_dollars ~ q_non_dac, data = data)
```

```{r}
#plot the linear regression for DAC
# ggplot(data, aes(x = q_dac, y = price_dollars)) +
#   geom_point() +
#   labs(title = "DAC Demand Curve",
#        x = "Quantity",
#        y = "Price") +
#   geom_abline(intercept = coef(dac)[1], slope = coef(dac)[2], color = "red")+
#   theme_minimal()
```

```{r}
#plot the linear regression for non-DAC
# ggplot(data, aes(x = q_non_dac, y = price_dollars)) +
#   geom_point() +
#   labs(title = "DAC Demand Curve",
#        x = "Quantity",
#        y = "Price") +
#   geom_abline(intercept = coef(non_dac)[1], slope = coef(non_dac)[2], color = "red")+
#   theme_minimal()
```

```{r}
#pivot the data to have all dac and non-dac in one column
data_pivot <- data %>% 
  pivot_longer(cols = c(q_dac, q_non_dac), names_to = "group", values_to = "quantity")
```

```{r}
#plot the linear regression for both DAC and non-DAC
ggplot(data_pivot, aes(x = quantity, y = price_dollars, color = group)) +
  geom_point() +
  labs(title = "DAC and Non-DAC Demand Curves",
       x = "Quantity",
       y = "Price") +
  geom_abline(intercept = coef(dac)[1], slope = coef(dac)[2], color = "dodgerblue") +
  geom_abline(intercept = coef(non_dac)[1], slope = coef(non_dac)[2], color = "orangered1")+ 
  scale_color_manual(values = c("dodgerblue", "orangered1"), 
                     labels = c("DAC", "Non-DAC")) +
  scale_y_continuous(limits = c(0, 180000)) +
  scale_x_continuous(limits = c(0, 80000)) +
  theme_bw()

```

Reasons that may explain the differences in demand estimates:

-   Income: DAC communities might experience lower income levels compared to non-DAC communities, impacting their willingness to pay.

-   Education: DAC communities may have lower levels of education compared to non-DAC communities, impacting their familiarity with EV technology and its advantages.

-   Availability of Charging Stations: DAC communities may encounter limited access to charging stations compared to non-DAC communities, potentially influencing their inclination towards EV adoption.

## 2. Marginal Externality cost per EV Produced

One kilogram (kg) of lithium is estimated to cause \$300 dollars worth of damage in health costs to local communities living near mines. Each EV requires a lithium ion battery containing 63kg of lithium. Assuming there are no other externalities caused by EV production, what is the marginal externality cost per EV produced?

```{r}
# Define the marginal externality cost per EV produced
marginal_ext_cost <- 300 * 63
```

The marginal externality cost per EV produced is \$18,900.

```{r}
#graph the marginal externality cost line on the graph
ggplot(data_pivot, aes(x = quantity, y = price_dollars, color = group)) +
  geom_point() +
  labs(title = "DAC and Non-DAC Demand Curves",
       subtitle = "with Marginal Externality Cost Line",
       x = "Quantity",
       y = "Price") +
  geom_abline(intercept = coef(dac)[1], slope = coef(dac)[2], color = "dodgerblue") +
  geom_abline(intercept = coef(non_dac)[1], slope = coef(non_dac)[2], color = "orangered1") +
geom_hline(yintercept = 18900, color = "palegreen3") +  # marginal externality cost line
  scale_color_manual(values = c("dodgerblue", "orangered1"), 
                     labels = c("DAC", "Non-DAC")) +
  scale_y_continuous(limits = c(0, 180000)) +
  scale_x_continuous(limits = c(0, 80000)) +
  theme_bw()

```


## 3. Describe the current equilibrium:

<!-- -->

### a. What is the aggregate annual demand curve for EVs?

Step 1: Flip the DAC and Non-Dac demand curve $$
    Pdac =  -6.61Q + 116854.84
    $$ $$
    Qdac = -0.15P + 17678.5
    $$ $$
    Pnon-dac=  -2.73Q + 158034.28
    $$ $$
    Qnon-dac = -0.36P + 57888
    $$ Step 2: Add the demand curves $$
    (-0.15P+17678.5)+(-0.36P+57888) = 
$$ $$
  Qaggregate = -0.51P + 75566.5 
$$

Step 3: Flip back to Q

The aggregate demand is: $$
Q = -1.96Q + 148169
$$

###b. What is the supply curve for EVs?

EVs are currently at a price of \$50,000. We can plug this into our aggregate demand equation to find Q: 
$$
Q = -1.96(50,000) + 148169 = 50,169
$$
Current equilibrium Q ~ 50,000. We know the supply curve starts at the orgin, so we can assume it has a slope of 1. 

$$
P = Q
$$

```{r}
ggplot(data_pivot, aes(x = quantity, y = price_dollars)) +
  geom_point(aes(color = group)) +
  labs(title = "DAC and Non-DAC Supply & Demand Curves",
       x = "Quantity",
       y = "Price") +
  geom_abline(aes(intercept = coef(dac)[1], slope = coef(dac)[2]), color = "dodgerblue") +
  geom_abline(aes(intercept = coef(non_dac)[1], slope = coef(non_dac)[2]), color = "orangered1") +
  geom_hline(yintercept = 18900, color = "palegreen3") +  # marginal externality cost line
  geom_abline(intercept = 0, slope = 1, color = "orange") + # supply curve
  scale_color_manual(values = c("dodgerblue", "orangered1", "palegreen3", "orange"), 
                     labels = c("DAC", "Non-DAC", "Marginal Cost", "Supply")) +
  scale_y_continuous(limits = c(0, 180000)) +
  scale_x_continuous(limits = c(0, 80000)) +
  theme_bw()

```

###c. What is the “benefit” to consumers under the status quo?
SAM IS ASKING TA

###d. What is the “benefit” to producers under the status quo?
Producer surplus = $$(50,000 * 50,000)/2 = 125,000,000,000$$

###e. What is the environmental cost under the status quo?
Environmental cost = Marginal externality cost per EV produced * Q

Environmental cost = $$ 18,900 * 50,000 = 945,000,000 $$

## 4. How is the current consumer benefit divided between DAC and non-DAC consumers?

5\. Derive the optimal EV tax (in \$ per vehicle) to internalize the lithium mining externality. Noting that recent research has shown that DACs are far more likely to contain mining activity, assume that the mining externality is borne entirely by the DAC group. What would be the effects of this tax on:

a\. The amount of EVs produced and consumed

b\. The price of EVs

c\. Overall welfare of non-DAC consumers

d\. Overall welfare of DAC consumers

e\. EV producers

f\. Total environmental damage

g\. Total tax revenue generated

6\. Now, assume that all revenue from the EV tax will be redistributed to the consumers in proportion to their pre-tax consumption of EVs. For example, if 80% of the EVs were consumed by non-DAC consumers, then they get 80% of the tax revenue. Calculate the effects of this EV tax on:

a\. Overall welfare of non-DAC consumers

b\. Overall welfare of DAC consumers

c\. EV producers

7\. Based on your findings, use 1-3 sentences to answer the following (qualitatively only):

a\. Are non-DAC consumers likely to support the EV tax? How would the redistribution regime in question #6 affect their support for the tax?

b\. Are DAC consumers likely to support the EV tax? How would the redistribution regime in question #6 affect their support for the tax?
